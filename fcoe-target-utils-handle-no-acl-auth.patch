From aec6b4968143b39515d2e46e522c969c23378ae3 Mon Sep 17 00:00:00 2001
From: Andy Grover <agrover@redhat.com>
Date: Thu, 19 Apr 2012 12:56:20 -0700
Subject: [PATCH 1/2] Properly handle fabrics that don't support acl auth

Signed-off-by: Andy Grover <agrover@redhat.com>
---
 targetcli/ui_target.py |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/targetcli/ui_target.py b/targetcli/ui_target.py
index 9457284..8d29c75 100644
--- a/targetcli/ui_target.py
+++ b/targetcli/ui_target.py
@@ -406,7 +406,8 @@ class UITPG(UIRTSLibNode):
         else:
             description, status = ("disabled", False)
 
-        if int(self.rtsnode.get_attribute("authentication")):
+        if self.rtsnode.has_feature("acls_auth") and \
+                int(self.rtsnode.get_attribute("authentication")):
             description += ", auth"
         return (description, status)
 
@@ -630,7 +631,8 @@ class UINodeACL(UIRTSLibNode):
 
         status = None
         na = self.rtsnode
-        if int(self.parent.parent.rtsnode.get_attribute("authentication")):
+        if self.rtsnode.has_feature("acls_auth") and \
+                int(self.parent.parent.rtsnode.get_attribute("authentication")):
             if not (na.chap_password and na.chap_userid):
                 status = False
 
-- 
1.7.1

